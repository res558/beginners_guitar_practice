<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beginner's Guitar Practice</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preload" href="practice/sun.svg" as="image">
    <link rel="preload" href="practice/moon.svg" as="image">
    <style>
        :root {
            --primary-bg: #f9f9f9;
            --primary-text: #222;
            --accent: #4f8cff;
            --card-bg: #fff;
            --border: #e0e0e0;
            --button-bg: #4f8cff;
            --button-text: #fff;
            --remove-bg: #ff4f4f;
            --remove-text: #fff;
        }

        [data-theme="dark"] {
            --primary-bg: #181a1b;
            --primary-text: #f1f1f1;
            --accent: #7ab7ff;
            --card-bg: #23272a;
            --border: #333;
            --button-bg: #7ab7ff;
            --button-text: #181a1b;
            --remove-bg: #ff4f4f;
            --remove-text: #fff;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--primary-bg);
            color: var(--primary-text);
            min-height: 100vh;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            margin: 80px auto 100px auto;
            padding: 24px;
            background: var(--card-bg);
            border-radius: 18px;
            box-shadow: 0 2px 16px 0 rgba(0, 0, 0, 0.06);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .title {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        .theme-toggle {
            background: var(--border);
            border: none;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.08);
        }

        .theme-toggle:hover {
            background: var(--accent);
        }

        .theme-toggle img {
            width: 28px;
            height: 28px;
            pointer-events: none;
        }

        .header-container {
            background: transparent !important;
            box-shadow: none !important;
        }

        .accordion {
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 32px;
            border: 1px solid var(--border);
        }

        .accordion-group {
            border-bottom: 1px solid var(--border);
        }

        .accordion-group:last-child {
            border-bottom: none;
        }

        .accordion-header {
            background: var(--card-bg);
            color: var(--primary-text);
            padding: 18px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background 0.2s;
        }

        .accordion-header:hover {
            background: var(--border);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            background: var(--card-bg);
            transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0 20px;
        }

        .accordion-group.active .accordion-content {
            padding: 16px 20px 20px 20px;
            max-height: 200px;
        }

        .accordion-arrow {
            transition: transform 0.3s;
        }

        .accordion-group.active .accordion-arrow {
            transform: rotate(90deg);
        }

        table.exercise-list {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 32px;
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        table.exercise-list th,
        table.exercise-list td {
            padding: 12px 10px;
            text-align: left;
        }

        table.exercise-list th {
            background: var(--border);
            color: var(--primary-text);
            font-weight: 600;
        }

        table.exercise-list tr:not(:last-child) td {
            border-bottom: 1px solid var(--border);
        }

        .remove-btn {
            background: var(--remove-bg);
            color: var(--remove-text);
            border: none;
            border-radius: 6px;
            padding: 6px 14px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
        }

        .remove-btn:hover {
            background: #d32f2f;
        }

        /* Strumming pattern toggle button active state */
        .strum-btn.active {
            background: var(--accent) !important;
            color: #fff;
            border-color: var(--accent);
            border: solid 2px #000
        }

        .strum-btn.active svg path {
            stroke: #fff;
            border: solid 2px #000
        }

        .fixed-bottom {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100vw;
            background: var(--card-bg);
            box-shadow: 0 -2px 16px 0 rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: center;
            padding: 18px 0 18px 0;
            z-index: 100;
        }

        .start-btn {
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 24px;
            padding: 14px 38px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.08);
            transition: background 0.2s;
        }

        .start-btn:hover {
            background: #2563eb;
            color: #fff;
        }

        @media (max-width: 700px) {
            .container {
                margin: 60px 0 100px 0;
                padding: 10px;
                border-radius: 0;
                max-width: 100vw;
            }

            .header {
                margin-bottom: 18px;
            }

            .title {
                font-size: 1.3rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                margin: 40px 0 100px 0;
                padding: 2vw;
            }

            .start-btn {
                width: 90vw;
                padding: 14px 0;
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="header"
        style="position:fixed;top:0;right:0;left:0;z-index:99;background:var(--card-bg);box-shadow:0 2px 8px 0 rgba(0,0,0,0.04);padding:0;">
        <div class="container header-container"
            style="position:relative;margin:0 auto;padding:10px 24px;max-width:600px;background:transparent;box-shadow:none;">
            <span class="title">Build Your Practice Session</span>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle light/dark mode"
                style="position:fixed;top:1%;right:1%;">
                <img id="themeIcon" src="practice/moon.svg" alt="Toggle theme">
            </button>
        </div>
    </div>
    <div class="container">
        <div class="accordion" id="exerciseAccordion">
            <div class="accordion-group">
                <div class="accordion-header">
                    Spider Walk
                    <span class="accordion-arrow">▶</span>
                </div>
                <div class="accordion-content" style="overflow-y: auto;">
                    <div id="spiderWalkList">

                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-header">
                    Chord From/To
                    <span class="accordion-arrow">▶</span>
                </div>
                <div class="accordion-content">
                    <div id="chordFromToConfig" style="display:flex;gap:18px;margin-bottom:6px;flex-wrap:wrap;">
                        <div style="display:flex;flex-direction:column;min-width:70px;">
                            <label for="chordFromSelect" style="margin-bottom:2px;">From:</label>
                            <select id="chordFromSelect" style="width:70px;"></select>
                        </div>
                        <div style="display:flex;flex-direction:column;min-width:80px;">
                            <label for="chordToSelect" style="margin-bottom:2px;">To:</label>
                            <select id="chordToSelect" multiple size="7"
                                style="min-width:80px;max-width:100px;"></select>
                        </div>
                        <div style="display:flex;flex-direction:column;min-width:70px;">
                            <label for="chordFromToMinutes" style="margin-bottom:2px;">Minutes:</label>
                            <select id="chordFromToMinutes" style="width:70px;">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                            </select>
                        </div>
                        <div style="flex-direction:column;justify-content:flex-start;">
                            <button id="addChordFromToBtn" style="margin-top:18px;">Add</button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-header">
                    Chords Random
                    <span class="accordion-arrow">▶</span>
                </div>
                <div class="accordion-content">
                    <div id="chordsRandomConfig" style="display:flex;gap:18px;margin-bottom:6px;flex-wrap:wrap;">
                        <div style="display:flex;flex-direction:column;min-width:180px;">
                            <label for="chordsRandomSelect" style="margin-bottom:2px;">Select your chords</label>
                            <select id="chordsRandomSelect" multiple size="7"
                                style="min-width:80px;max-width:100px;"></select>
                        </div>
                        <div style="display:flex;flex-direction:column;min-width:70px;">
                            <label for="chordsRandomMinutes" style="margin-bottom:2px;">Minutes:</label>
                            <select id="chordsRandomMinutes" style="width:70px;">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>
                        </div>
                        <div style="flex-direction:column;justify-content:flex-start;">
                            <button id="addChordsRandomBtn" style="margin-top:18px;">Add</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-header">
                    Strumming
                    <span class="accordion-arrow">▶</span>
                </div>
                <div class="accordion-content">
                    <div id="strummingConfig"
                        style="display:flex;gap:18px;margin-bottom:6px;flex-wrap:wrap;align-items:flex-start;">
                        <div style="display:flex;flex-direction:column;min-width:80px;">
                            <label for="strummingChordsSelect" style="margin-bottom:2px;">Chords</label>
                            <select id="strummingChordsSelect" multiple size="7"
                                style="min-width:80px;max-width:100px;"></select>
                        </div>
                        <div style="display:flex;flex-direction:column;min-width:260px;">
                            <label style="margin-bottom:2px;">Strumming Pattern</label>
                            <div id="strummingPatternBtns" style="display:flex;gap:2px;">
                                <button type="button" class="strum-btn" data-idx="0" data-label="1" title="1"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">1</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 4v8M9 12l-3-3M9 12l3-3" stroke="#7a7a7a" stroke-width="2"
                                            fill="none" stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="1" data-label="+" title="+"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">+</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 14V6M9 6l-3 3M9 6l3 3" stroke="#7a7a7a" stroke-width="2" fill="none"
                                            stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="2" data-label="2" title="2"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">2</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 4v8M9 12l-3-3M9 12l3-3" stroke="#7a7a7a" stroke-width="2"
                                            fill="none" stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="3" data-label="+" title="+"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">+</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 14V6M9 6l-3 3M9 6l3 3" stroke="#7a7a7a" stroke-width="2" fill="none"
                                            stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="4" data-label="3" title="3"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">3</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 4v8M9 12l-3-3M9 12l3-3" stroke="#7a7a7a" stroke-width="2"
                                            fill="none" stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="5" data-label="+" title="+"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">+</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 14V6M9 6l-3 3M9 6l3 3" stroke="#7a7a7a" stroke-width="2" fill="none"
                                            stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="6" data-label="4" title="4"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">4</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 4v8M9 12l-3-3M9 12l3-3" stroke="#7a7a7a" stroke-width="2"
                                            fill="none" stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button type="button" class="strum-btn" data-idx="7" data-label="+" title="+"
                                    style="width:32px;height:48px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#f5f7fa;border:1px solid #bfc9d1;border-radius:6px;cursor:pointer;">
                                    <span style="font-size:1.1em;">+</span>
                                    <svg width="18" height="18" viewBox="0 0 18 18">
                                        <path d="M9 14V6M9 6l-3 3M9 6l3 3" stroke="#7a7a7a" stroke-width="2" fill="none"
                                            stroke-linecap="round" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div style="display:flex;flex-direction:column;min-width:70px;">
                            <label for="strummingMinutes" style="margin-bottom:2px;">Minutes:</label>
                            <select id="strummingMinutes" style="width:70px;">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                            </select>
                        </div>
                        <div style="flex-direction:column;justify-content:flex-start;">
                            <button id="addStrummingBtn" style="margin-top:18px;">Add</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <table class="exercise-list">
            <thead>
                <tr>
                    <th>Index</th>
                    <th>Name</th>
                    <th>Time</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="exerciseTableBody" style="overflow-y: auto;">
                <!-- Dynamic rows will be rendered here by JS -->
            </tbody>
        </table>
        <br /><br /><br /><br /><br /><br />
    </div>
    <div class="fixed-bottom">
        <button class="start-btn" onclick="startPractice()">Open Practice</button>
    </div>
    <script>
        // Spider Walk exercise note/fret map
        // Key: matches data-name of .spider-item, Value: array of "String,Fret" (example values, edit as needed)
        const SPIDER_WALK_MAP = {
            "1234 - 1 to 5": [",", ",", ",", ",", "E,1", "E,2", "E,3", "E,4", "A,1", "A,2", "A,3", "A,4", "D,1", "D,2", "D,3", "D,4", "G,1", "G,2", "G,3", "G,4", "B,1", "B,2", "B,3", "B,4", "e,1", "e,2", "e,3", "e,4", ",", "e,4", "e,3", "e,2", "e,1", "B,4", "B,3", "B,2", "B,1", "G,4", "G,3", "G,2", "G,1", "D,4", "D,3", "D,2", "D,1", "A,4", "A,3", "A,2", "A,1", "E,4", "E,3", "E,2", "E,1", ",", ",", "E,2", "E,3", "E,4", "E,5", "A,2", "A,3", "A,4", "A,5", "D,2", "D,3", "D,4", "D,5", "G,2", "G,3", "G,4", "G,5", "B,2", "B,3", "B,4", "B,5", "e,2", "e,3", "e,4", "e,5", ",", "e,5", "e,4", "e,3", "e,2", "B,5", "B,4", "B,3", "B,2", "G,5", "G,4", "G,3", "G,2", "D,5", "D,4", "D,3", "D,2", "A,5", "A,4", "A,3", "A,2", "E,5", "E,4", "E,3", "E,2", ",", ",", "E,3", "E,4", "E,5", "E,6", "A,3", "A,4", "A,5", "A,6", "D,3", "D,4", "D,5", "D,6", "G,3", "G,4", "G,5", "G,6", "B,3", "B,4", "B,5", "B,6", "e,3", "e,4", "e,5", "e,6", ",", "e,6", "e,5", "e,4", "e,3", "B,6", "B,5", "B,4", "B,3", "G,6", "G,5", "G,4", "G,3", "D,6", "D,5", "D,4", "D,3", "A,6", "A,5", "A,4", "A,3", "E,6", "E,5", "E,4", "E,3", ",", ",", "E,4", "E,5", "E,6", "E,7", "A,4", "A,5", "A,6", "A,7", "D,4", "D,5", "D,6", "D,7", "G,4", "G,5", "G,6", "G,7", "B,4", "B,5", "B,6", "B,7", "e,4", "e,5", "e,6", "e,7", ",", "e,7", "e,6", "e,5", "e,4", "B,7", "B,6", "B,5", "B,4", "G,7", "G,6", "G,5", "G,4", "D,7", "D,6", "D,5", "D,4", "A,7", "A,6", "A,5", "A,4", "E,7", "E,6", "E,5", "E,4", ",", ",", "E,5", "E,6", "E,7", "E,8", "A,5", "A,6", "A,7", "A,8", "D,5", "D,6", "D,7", "D,8", "G,5", "G,6", "G,7", "G,8", "B,5", "B,6", "B,7", "B,8", "e,5", "e,6", "e,7", "e,8", ",", "e,8", "e,7", "e,6", "e,5", "B,8", "B,7", "B,6", "B,5", "G,8", "G,7", "G,6", "G,5", "D,8", "D,7", "D,6", "D,5", "A,8", "A,7", "A,6", "A,5", "E,8", "E,7", "E,6", "E,5", ",", ",", ","],
            "1234 - 5 to 9": [",", ",", ",", ",", "E,5", "E,6", "E,7", "E,8", "A,5", "A,6", "A,7", "A,8", "D,5", "D,6", "D,7", "D,8", "G,5", "G,6", "G,7", "G,8", "B,5", "B,6", "B,7", "B,8", "e,5", "e,6", "e,7", "e,8", ",", "e,8", "e,7", "e,6", "e,5", "B,8", "B,7", "B,6", "B,5", "G,8", "G,7", "G,6", "G,5", "D,8", "D,7", "D,6", "D,5", "A,8", "A,7", "A,6", "A,5", "E,8", "E,7", "E,6", "E,5", ",", ",", "E,6", "E,7", "E,8", "E,9", "A,6", "A,7", "A,8", "A,9", "D,6", "D,7", "D,8", "D,9", "G,6", "G,7", "G,8", "G,9", "B,6", "B,7", "B,8", "B,9", "e,6", "e,7", "e,8", "e,9", ",", "e,9", "e,8", "e,7", "e,6", "B,9", "B,8", "B,7", "B,6", "G,9", "G,8", "G,7", "G,6", "D,9", "D,8", "D,7", "D,6", "A,9", "A,8", "A,7", "A,6", "E,9", "E,8", "E,7", "E,6", ",", ",", "E,7", "E,8", "E,9", "E,10", "A,7", "A,8", "A,9", "A,10", "D,7", "D,8", "D,9", "D,10", "G,7", "G,8", "G,9", "G,10", "B,7", "B,8", "B,9", "B,10", "e,7", "e,8", "e,9", "e,10", ",", "e,10", "e,9", "e,8", "e,7", "B,10", "B,9", "B,8", "B,7", "G,10", "G,9", "G,8", "G,7", "D,10", "D,9", "D,8", "D,7", "A,10", "A,9", "A,8", "A,7", "E,10", "E,9", "E,8", "E,7", ",", ",", "E,8", "E,9", "E,10", "E,11", "A,8", "A,9", "A,10", "A,11", "D,8", "D,9", "D,10", "D,11", "G,8", "G,9", "G,10", "G,11", "B,8", "B,9", "B,10", "B,11", "e,8", "e,9", "e,10", "e,11", ",", "e,11", "e,10", "e,9", "e,8", "B,11", "B,10", "B,9", "B,8", "G,11", "G,10", "G,9", "G,8", "D,11", "D,10", "D,9", "D,8", "A,11", "A,10", "A,9", "A,8", "E,11", "E,10", "E,9", "E,8", ",", ",", "E,9", "E,10", "E,11", "E,12", "A,9", "A,10", "A,11", "A,12", "D,9", "D,10", "D,11", "D,12", "G,9", "G,10", "G,11", "G,12", "B,9", "B,10", "B,11", "B,12", "e,9", "e,10", "e,11", "e,12", ",", "e,12", "e,11", "e,10", "e,9", "B,12", "B,11", "B,10", "B,9", "G,12", "G,11", "G,10", "G,9", "D,12", "D,11", "D,10", "D,9", "A,12", "A,11", "A,10", "A,9", "E,12", "E,11", "E,10", "E,9", ",", ",", ","],
            "Woven": [",", ",", ",", ",", "E,1", "A,3", "E,2", "A,4", "E,3", "A,1", "E,4", "A,2", ",", "A,1", "D,3", "A,2", "D,4", "A,3", "D,1", "A,4", "D,2", ",", "D,1", "G,3", "D,2", "G,4", "D,3", "G,1", "D,4", "G,2", ",", "G,1", "B,3", "G,2", "B,4", "G,3", "B,1", "G,4", "B,2", ",", "B,1", "e,3", "B,2", "e,4", "B,3", "e,1", "B,4", "e,2", ",", ",", "e,2", "B,4", "e,1", "B,3", "e,4", "B,2", "e,3", "B,1", ",", "B,2", "G,4", "B,1", "G,3", "B,4", "G,2", "B,3", "G,1", ",", "G,2", "D,4", "G,1", "D,3", "G,4", "D,2", "G,3", "D,1", ",", "D,2", "A,4", "D,1", "A,3", "D,4", "A,2", "D,3", "A,1", ",", "A,2", "E,4", "A,1", "E,3", "A,4", "E,2", "A,3", "E,1", ",", ",", ","],
            "Woven Stretch": [",", ",", ",", ",", "E,1", "A,3", "E,2", "A,4", "E,3", "A,1", "E,4", "A,2", "E,1", "D,3", "E,2", "D,4", "E,3", "D,1", "E,4", "D,2", "E,1", "G,3", "E,2", "G,4", "E,3", "G,1", "E,4", "G,2", "E,1", "B,3", "E,2", "B,4", "E,3", "B,1", "E,4", "B,2", "E,1", "e,3", "E,2", "e,4", "E,3", "e,1", "E,4", "e,2", ",", ",", ","],
            "Woven Spaced": [",", ",", ",", ",", "E,1", "D,3", "E,2", "D,4", "E,3", "D,1", "E,4", "D,2", ",", "A,1", "G,3", "A,2", "G,4", "A,3", "G,1", "A,4", "G,2", ",", "D,1", "B,3", "D,2", "B,4", "D,3", "B,1", "D,4", "B,2", ",", "G,1", "e,3", "G,2", "e,4", "G,3", "e,1", "G,4", "e,2", ",", ",", ","],
            "13 24 Wave": [",", ",", ",", ",", "E,1", "E,3", "A,2", "A,4", "D,1", "D,3", "G,2", "G,4", "B,1", "B,3", "e,1", "e,4", ",", "e,1", "e,3", "B,2", "B,4", "G,1", "G,3", "D,2", "D,4", "A,1", "A,3", "E,2", "E,4", ",", ",", "E,2", "E,4", "A,3", "A,5", "D,2", "D,4", "G,3", "G,5", "B,2", "B,4", "e,2", "e,5", ",", "e,2", "e,4", "B,3", "B,5", "G,2", "G,4", "D,3", "D,5", "A,2", "A,4", "E,3", "E,5", ",", ",", "E,3", "E,5", "A,4", "A,6", "D,3", "D,5", "G,4", "G,6", "B,3", "B,5", "e,3", "e,6", ",", "e,3", "e,5", "B,4", "B,6", "G,3", "G,5", "D,4", "D,6", "A,3", "A,5", "E,4", "E,6", ",", ",", "E,4", "E,6", "A,5", "A,7", "D,4", "D,6", "G,5", "G,7", "B,4", "B,6", "e,4", "e,7", ",", "e,4", "e,6", "B,5", "B,7", "G,4", "G,6", "D,5", "D,7", "A,4", "A,6", "E,5", "E,7", ",", ",", "E,5", "E,7", "A,6", "A,8", "D,5", "D,7", "G,6", "G,8", "B,5", "B,7", "e,5", "e,8", ",", "e,5", "e,7", "B,6", "B,8", "G,5", "G,7", "D,6", "D,8", "A,5", "A,7", "E,6", "E,8", ",", ",", ","],
            "13 Spaced": [",", ",", ",", ",", "E,1", "E,3", "D,3", "D,1", "A,1", "A,3", "G,3", "G,1", "D,1", "D,3", "B,3", "B,1", "G,1", "G,3", "e,3", "e,1", "e,1", "e,3", "G,3", "G,1", "B,1", "B,3", "D,3", "D,1", "G,1", "G,3", "A,3", "A,1", "D,1", "D,3", "E,3", "E,1", ",", ",", ","],
            "Triangle": [",", ",", ",", ",", "E,1", "A,2", "D,3", "G,4", "G,4", "D,2", "A,3", "E,4", "A,1", "D,2", "G,3", "B,4", "B,1", "G,2", "D,3", "A,4", "D,1", "G,2", "B,3", "e,4", "e,1", "B,2", "G,3", "D,4", "D,1", "G,2", "B,3", "e,4", "e,1", "B,2", "G,3", "D,4", "A,1", "D,2", "G,3", "B,4", "B,1", "G,2", "D,3", "A,4", "E,1", "A,2", "D,3", "G,4", "G,1", "D,2", "A,3", "E,4", ",", ",", ","],
            "Diagonal Asc": [",", ",", ",", ",", "E,1", "A,2", "D,3", "G,4", "A,1", "D,2", "G,3", "B,4", "D,1", "G,2", "B,3", "e,4", "e,1", "B,2", "G,3", "D,4", "B,1", "G,2", "D,3", "A,4", "G,1", "D,2", "A,3", "E,4", ",", ",", ","],
            "Diagonal Desc": [",", ",", ",", ",", "E,4", "A,3", "D,2", "G,1", "A,4", "D,3", "G,2", "B,1", "D,4", "G,3", "B,2", "e,1", "e,4", "B,3", "G,2", "D,1", "B,4", "G,3", "D,2", "A,1", "G,4", "D,3", "A,2", "E,1", ",", ",", ","],
            "143 Stretch": [",", ",", ",", ",", "E,1", "e,4", "e,1", "E,4", "A,1", "B,4", "B,1", "A,3", "D,1", "G,3", "G,1", "D,3", "A,1", "B,4", "B,1", "A,3", ",", ",", ","],
            "Mini Wave": [",", ",", ",", ",", "E,1", "E,2", "E,3", "E,4", "A,1", "E,2", "E,3", "E,4", "A,1", "A,2", "E,3", "E,4", "A,1", "A,2", "A,3", "E,4", "A,1", "A,2", "A,3", "A,4", "D,1", "A,2", "A,3", "A,4", "D,1", "D,2", "A,3", "A,4", "D,1", "D,2", "D,3", "A,4", "D,1", "D,2", "D,3", "D,4", "G,1", "D,2", "D,3", "D,4", "G,1", "G,2", "D,3", "D,4", "G,1", "G,2", "G,3", "D,4", "G,1", "G,2", "G,3", "G,4", "B,1", "G,2", "G,3", "G,4", "B,1", "B,2", "G,3", "G,4", "B,1", "B,2", "B,3", "G,4", "B,1", "B,2", "B,3", "B,4", "e,1", "B,2", "B,3", "B,4", "e,1", "e,2", "B,3", "B,4", "e,1", "e,2", "e,3", "B,4", "e,1", "e,2", "e,3", "e,4", ",", ",", "e,4", "e,3", "e,2", "e,1", "B,4", "e,3", "e,2", "e,1", "B,4", "B,3", "e,2", "e,1", "B,4", "B,3", "B,2", "B,1", "e,1", "B,4", "B,3", "B,2", "B,1", "G,4", "B,3", "B,2", "B,1", "G,4", "G,3", "B,2", "B,1", "G,4", "G,3", "G,2", "B,1", "G,4", "G,3", "G,2", "G,1", "D,4", "G,3", "G,2", "G,1", "D,4", "D,3", "G,2", "G,1", "D,4", "D,3", "D,2", "G,1", "D,4", "D,3", "D,2", "D,1", "A,4", "D,3", "D,2", "D,1", "A,4", "A,3", "D,2", "D,1", "A,4", "A,3", "A,2", "D,1", "A,4", "A,3", "A,2", "A,1", "E,4", "A,3", "A,2", "A,1", "E,4", "E,3", "A,2", "A,1", "E,4", "E,3", "E,2", "A,1", "E,4", "E,3", "E,2", "E,1", ",", ",", ","],
            "Finger Pulse": [",", ",", ",", ",", "E,1", "E,2", "E,3", "E,4", "A,1", "E,2", "E,3", "E,4", "E,1", "A,2", "E,3", "E,4", "E,1", "E,2", "A,3", "E,4", "E,1", "E,2", "E,3", "A,4", "A,1", "A,2", "A,3", "A,4", "D,1", "A,2", "A,3", "A,4", "A,1", "D,2", "A,3", "A,4", "A,1", "A,2", "D,3", "A,4", "A,1", "A,2", "A,3", "D,4", "D,1", "D,2", "D,3", "D,4", "G,1", "D,2", "D,3", "D,4", "D,1", "G,2", "D,3", "D,4", "D,1", "D,2", "G,3", "D,4", "D,2", "D,2", "D,3", "G,4", "G,1", "G,2", "G,3", "G,4", "B,1", "G,2", "G,3", "G,4", "G,1", "B,2", "G,3", "G,4", "G,1", "G,2", "B,3", "G,4", "G,1", "G,2", "G,3", "B,4", "B,1", "B,2", "B,3", "B,4", "e,1", "B,2", "B,3", "B,4", "B,1", "e,2", "B,3", "B,4", "B,1", "B,2", "e,3", "B,4", "B,1", "B,2", "B,3", "e,4", "e,1", "e,2", "e,3", "e,4", ",", ",", ",", "e,4", "e,3", "e,2", "e,1", "B,4", "e,3", "e,2", "e,1", "e,4", "B,3", "e,2", "e,1", "e,4", "e,3", "B,2", "e,1", "e,4", "e,3", "e,2", "B,1", "B,4", "B,3", "B,2", "B,1", "G,4", "B,3", "B,2", "B,1", "B,4", "G,3", "B,2", "B,1", "B,4", "B,3", "G,2", "B,1", "B,4", "B,3", "B,2", "G,1", "G,4", "G,3", "G,2", "G,1", "D,4", "G,3", "G,2", "G,1", "G,4", "D,3", "G,2", "G,1", "G,4", "G,3", "D,2", "G,1", "G,4", "G,3", "G,2", "D,1", "D,4", "D,3", "D,2", "D,1", "A,4", "D,3", "D,2", "D,1", "D,4", "A,3", "D,2", "D,1", "D,4", "D,3", "A,2", "D,1", "D,4", "D,3", "D,2", "A,1", "A,4", "A,3", "A,2", "A,1", "E,4", "A,3", "A,2", "A,1", "A,4", "E,3", "A,2", "A,1", "A,4", "A,3", "E,2", "A,1", "A,4", "A,3", "A,2", "E,1", "E,4", "E,3", "E,2", "E,1", ",", ",", ","]
        };

        // Chord image map with <mode> placeholder
        const CHORD_IMAGE_MAP = {
            'A': 'practice/<mode>/A.png',
            'Am': 'practice/<mode>/Am.png',
            'C': 'practice/<mode>/C.png',
            'D': 'practice/<mode>/D.png',
            'Dm': 'practice/<mode>/Dm.png',
            'E': 'practice/<mode>/E.png',
            'Em': 'practice/<mode>/Em.png',
            'F': 'practice/<mode>/F.png',
            'G': 'practice/<mode>/G.png'
        };

        // In-memory exercise list, loaded from localStorage if available
        let exerciseList = [];

        function startPractice() {
            const exerciseList = JSON.parse(localStorage.getItem('exerciseList')) || [];
            if (exerciseList.length === 0) {
                alert('Add at least one exercise to the queue.');
                return;
            }
            window.location.href = 'execution.html';
        }


        // Populate Chords Random select dynamically from CHORD_IMAGE_MAP
        function populateChordsRandomSelect() {
            const select = document.getElementById('chordsRandomSelect');
            if (!select) return;
            select.innerHTML = '';
            // Add 'None' as the first option and select it by default
            Object.keys(CHORD_IMAGE_MAP).forEach(key => {
                const opt = document.createElement('option');
                opt.value = key;
                opt.textContent = key;
                select.appendChild(opt);
            });
        }

        // Populate Strumming Chords select dynamically from CHORD_IMAGE_MAP, with 'None' as first option
        function populateStrummingChordsSelect() {
            const select = document.getElementById('strummingChordsSelect');
            if (!select) return;
            select.innerHTML = '';
            const noneOpt = document.createElement('option');
            noneOpt.value = 'None';
            noneOpt.textContent = 'None';
            select.appendChild(noneOpt);
            Object.keys(CHORD_IMAGE_MAP).forEach(key => {
                const opt = document.createElement('option');
                opt.value = key;
                opt.textContent = key;
                select.appendChild(opt);
            });
        }

        // Strumming pattern toggle logic
        function setupStrummingPatternToggles() {
            const btns = document.querySelectorAll('#strummingPatternBtns .strum-btn');
            btns.forEach(btn => {
                btn.dataset.active = '0'; // default inactive
                btn.classList.remove('active');
                btn.onclick = function () {
                    const isActive = this.dataset.active === '1';
                    if (isActive) {
                        this.dataset.active = '0';
                        this.classList.remove('active');
                    } else {
                        this.dataset.active = '1';
                        this.classList.add('active');
                    }
                };
            });
        }


        // Helper to get the correct image path for a chord and current mode
        function getChordImagePath(chord) {
            const mode = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
            const template = CHORD_IMAGE_MAP[chord];
            return template ? template.replace('<mode>', mode) : '';
        }
        // Accordion logic
        document.querySelectorAll('.accordion-header').forEach((header, idx) => {
            header.addEventListener('click', function () {
                const group = this.parentElement;
                const isActive = group.classList.contains('active');
                document.querySelectorAll('.accordion-group').forEach(g => g.classList.remove('active'));
                if (!isActive) group.classList.add('active');
            });
        });



        // Load from localStorage, sessionStorage, or cookie (priority: sessionStorage > localStorage > cookie)
        function loadExerciseList() {
            let saved = sessionStorage.getItem('exerciseList');
            if (!saved) {
                saved = localStorage.getItem('exerciseList');
            }
            if (!saved) {
                // Try cookie
                const match = document.cookie.match(/(?:^|; )exerciseList=([^;]*)/);
                if (match) {
                    try {
                        saved = decodeURIComponent(match[1]);
                    } catch (e) {
                        saved = null;
                    }
                }
            }
            if (saved) {
                try {
                    const arr = JSON.parse(saved);
                    if (Array.isArray(arr)) {
                        exerciseList = arr;
                    }
                } catch (e) {
                    exerciseList = [];
                }
            }
        }

        // Save to localStorage, sessionStorage, and cookie
        function saveExerciseList() {
            const str = JSON.stringify(exerciseList);
            localStorage.setItem('exerciseList', str);
            sessionStorage.setItem('exerciseList', str);
            // Set cookie for 7 days
            document.cookie = 'exerciseList=' + encodeURIComponent(str) + '; path=/; max-age=' + (60 * 60 * 24 * 7);
        }

        // Helper to update the exercise table
        function renderExerciseTable() {
            const tbody = document.getElementById('exerciseTableBody');
            tbody.innerHTML = '';
            exerciseList.forEach((ex, idx) => {
                const tr = document.createElement('tr');
                // For type 1 and 3, show type label; for type 2, just use ex.name
                let displayName = '';
                if (ex.type === 1) displayName = `Spider Walk - ${ex.name}`;
                else if (ex.type === 3) displayName = `Chords Random - ${ex.name}`;
                else if (ex.type === 4) displayName = ex.name;
                else displayName = ex.name;
                tr.innerHTML = `
                    <td>${ex.index}</td>
                    <td>${displayName}</td>
                    <td>${ex.duration}:00</td>
                    <td><button class="remove-btn">Remove</button></td>
                `;
                // Remove logic
                tr.querySelector('.remove-btn').addEventListener('click', function () {
                    exerciseList = exerciseList.filter(e => e.index !== ex.index);
                    // Re-index
                    exerciseList.forEach((e, i) => e.index = i + 1);
                    saveExerciseList();
                    renderExerciseTable();
                });
                tbody.appendChild(tr);
            });
        }

        // Add Spider Walk logic
        document.querySelectorAll('.add-spider-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const itemDiv = this.closest('.spider-item');
                const name = itemDiv.getAttribute('data-name');
                const duration = parseInt(itemDiv.querySelector('.minute-select').value, 10);
                // Add to exerciseList
                const obj = {
                    index: exerciseList.length + 1,
                    type: 1, // Spider Walk
                    name: name,
                    duration: duration,
                    chordFrom: '',
                    chordsTo: [],
                    spiderMap: SPIDER_WALK_MAP[name] || []
                };
                exerciseList.push(obj);
                saveExerciseList();
                renderExerciseTable();
            });
        });

        // Add Chord From/To logic
        const addChordFromToBtn = document.getElementById('addChordFromToBtn');
        if (addChordFromToBtn) {
            addChordFromToBtn.addEventListener('click', function () {
                const from = document.getElementById('chordFromSelect').value;
                const toSelect = document.getElementById('chordToSelect');
                const to = Array.from(toSelect.selectedOptions).map(opt => opt.value).filter(val => val !== from);
                const minutes = parseInt(document.getElementById('chordFromToMinutes').value, 10);
                if (!from || to.length === 0) {
                    alert('Please select a chord for From and at least one chord for To.');
                    return;
                }
                const name = `Chords from ${from} to ${to.join(', ')}`;
                const obj = {
                    index: exerciseList.length + 1,
                    type: 2, // Chord From/To
                    name: name,
                    duration: minutes,
                    chordFrom: from,
                    chordsTo: to
                };
                exerciseList.push(obj);
                saveExerciseList();
                renderExerciseTable();
            });
        }

        // Populate Chord From/To selects dynamically from CHORD_IMAGE_MAP
        function populateChordFromToSelects() {
            const fromSelect = document.getElementById('chordFromSelect');
            const toSelect = document.getElementById('chordToSelect');
            if (!fromSelect || !toSelect) return;
            fromSelect.innerHTML = '';
            toSelect.innerHTML = '';
            Object.keys(CHORD_IMAGE_MAP).forEach(key => {
                const optFrom = document.createElement('option');
                optFrom.value = key;
                optFrom.textContent = key;
                fromSelect.appendChild(optFrom);
                const optTo = document.createElement('option');
                optTo.value = key;
                optTo.textContent = key;
                toSelect.appendChild(optTo);
            });
        }
        // On page load, load and render
        window.addEventListener('DOMContentLoaded', function () {
            loadExerciseList();
            renderExerciseTable();
            populateChordFromToSelects();
            populateChordsRandomSelect();
            populateStrummingChordsSelect();
            setupStrummingPatternToggles();

            // Function to build spider walk list dynamically
            function buildSpiderWalkList() {
                const container = document.getElementById('spiderWalkList');
                container.innerHTML = ''; // Clear anything existing

                Object.keys(SPIDER_WALK_MAP).forEach(key => {
                    const div = document.createElement('div');
                    div.className = 'spider-item';
                    div.setAttribute('data-name', key);
                    div.style = 'display:flex;align-items:center;gap:10px;margin-bottom:6px;';

                    const span = document.createElement('span');
                    span.textContent = key;
                    span.style = 'flex:1;';
                    div.appendChild(span);

                    const select = document.createElement('select');
                    select.className = 'minute-select';
                    select.style = 'width:50px;';
                    for (let i = 1; i <= 5; i++) {
                        const opt = document.createElement('option');
                        opt.value = i;
                        opt.textContent = i;
                        if (i === 3) opt.selected = true;
                        select.appendChild(opt);
                    }
                    div.appendChild(select);

                    const button = document.createElement('button');
                    button.className = 'add-spider-btn';
                    button.textContent = 'Add';
                    button.style = 'margin-left:8px;';
                    div.appendChild(button);

                    container.appendChild(div);
                });

                // After adding all buttons, re-bind the event listeners
                document.querySelectorAll('.add-spider-btn').forEach(btn => {
                    btn.addEventListener('click', function () {
                        const itemDiv = this.closest('.spider-item');
                        const name = itemDiv.getAttribute('data-name');
                        const duration = parseInt(itemDiv.querySelector('.minute-select').value, 10);
                        const obj = {
                            index: exerciseList.length + 1,
                            type: 1,
                            name: name,
                            duration: duration,
                            chordFrom: '',
                            chordsTo: [],
                            spiderMap: SPIDER_WALK_MAP[name] || []
                        };
                        exerciseList.push(obj);
                        saveExerciseList();
                        renderExerciseTable();
                    });
                });
            }

            // Build spider walk list
            buildSpiderWalkList();

            // Add Strumming logic
            const addStrummingBtn = document.getElementById('addStrummingBtn');
            if (addStrummingBtn) {
                addStrummingBtn.addEventListener('click', function () {
                    // Get minutes
                    const minutes = parseInt(document.getElementById('strummingMinutes').value, 10);
                    // Get strumming pattern states and build name and pattern array
                    const btns = document.querySelectorAll('#strummingPatternBtns .strum-btn');
                    let patternStr = '';
                    let patternArr = [];
                    btns.forEach(btn => {
                        const isActive = btn.dataset.active === '1';
                        patternArr.push(isActive ? 1 : 0);
                        // Down for 1,2,3,4 (even idx), Up for + (odd idx)
                        if (isActive) {
                            if (btn.dataset.label === '+') patternStr += 'U';
                            else patternStr += 'D';
                        }
                    });
                    // If no pattern selected, alert
                    if (patternArr.every(v => v === 0)) {
                        alert('Please select at least one strumming pattern.');
                        return;
                    }
                    // Get selected chords from strummingChordsSelect for the name
                    const strummingChordsSelect = document.getElementById('strummingChordsSelect');
                    let selectedRandomChords = [];
                    if (strummingChordsSelect) {
                        selectedRandomChords = Array.from(strummingChordsSelect.selectedOptions).map(opt => opt.value).filter(v => v !== 'None');
                    }
                    // Get selected chords for the exercise object (from strummingChordsSelect)
                    const chordsSelect = document.getElementById('strummingChordsSelect');
                    const selectedChords = Array.from(chordsSelect.selectedOptions).map(opt => opt.value);
                    if (selectedChords.length === 0) {
                        alert('Please select at least one chord for strumming.');
                        return;
                    }
                    // Build the name as requested
                    let name = `Strum ${patternStr}`;
                    if (selectedRandomChords.length > 0) {
                        name += ' - ' + selectedRandomChords.join(', ');
                    }
                    const obj = {
                        index: exerciseList.length + 1,
                        type: 4,
                        name: name,
                        duration: minutes,
                        chordFrom: '',
                        chordsTo: selectedChords,
                        pattern: patternArr
                    };
                    exerciseList.push(obj);
                    saveExerciseList();
                    renderExerciseTable();
                });
            }
        });
        // Add Chords Random logic
        const addChordsRandomBtn = document.getElementById('addChordsRandomBtn');
        if (addChordsRandomBtn) {
            addChordsRandomBtn.addEventListener('click', function () {
                const select = document.getElementById('chordsRandomSelect');
                const minutes = parseInt(document.getElementById('chordsRandomMinutes').value, 10);
                const selected = Array.from(select.selectedOptions).map(opt => opt.value);
                if (selected.length === 0) {
                    alert('Please select at least one chord.');
                    return;
                }
                const name = `${selected.join(', ')}`;
                const obj = {
                    index: exerciseList.length + 1,
                    type: 3,
                    name: name,
                    duration: minutes,
                    chordFrom: '',
                    chordsTo: selected
                };
                exerciseList.push(obj);
                saveExerciseList();
                renderExerciseTable();
            });
        }

        // Strumming pattern toggle logic
        // (removed duplicate definition and call)
        // Theme toggle logic
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            sessionStorage.setItem('theme', theme);
            // Set cookie for 7 days
            document.cookie = 'theme=' + encodeURIComponent(theme) + '; path=/; max-age=' + (60 * 60 * 24 * 7);
            themeIcon.src = theme === 'dark' ? 'sun.svg' : 'moon.svg';
            themeIcon.alt = theme === 'dark' ? 'Dark mode' : 'Light mode';
        }
        // Initial theme
        function getSavedTheme() {
            let theme = sessionStorage.getItem('theme');
            if (!theme) theme = localStorage.getItem('theme');
            if (!theme) {
                const match = document.cookie.match(/(?:^|; )theme=([^;]*)/);
                if (match) {
                    try {
                        theme = decodeURIComponent(match[1]);
                    } catch (e) {
                        theme = null;
                    }
                }
            }
            return theme;
        }
        const userTheme = getSavedTheme();
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        setTheme(userTheme || (prefersDark ? 'dark' : 'light'));
        themeToggle.addEventListener('click', () => {
            const current = document.documentElement.getAttribute('data-theme');
            setTheme(current === 'dark' ? 'light' : 'dark');
        });

        // Remove button logic for initial static rows (if any)
        document.querySelectorAll('.remove-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                this.closest('tr').remove();
            });
        });
    </script>
</body>

</html>